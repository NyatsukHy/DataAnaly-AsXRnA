<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choosen Number Frequency Heatmap (1-30)</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Configure Tailwind for Inter font and custom colors -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'custom-orange': '#ff5722', // A vibrant orange for the max count
                    }
                }
            }
        }
    </script>
    <style>
        /* Custom styles for the grid cells */
        .grid-cell {
            /* aspect-ratio ensures cells are square and scale fluidly */
            aspect-ratio: 1 / 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #1f2937; /* Dark text */
            transition: background-color 0.3s ease;
            box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.1);
        }

        /* Enforce 6 columns for the 5x6 grid (30 numbers total) */
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
        }

        /* Responsive adjustments for the grid text */
        .cell-number-label {
            font-size: 0.65rem; /* Base size for mobile */
        }
        @media (min-width: 640px) {
            .cell-number-label {
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen font-sans p-4 sm:p-8">

    <div class="container mx-auto max-w-4xl bg-white shadow-2xl rounded-xl p-6 lg:p-10">
        <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-2">
            Number Frequency Heatmap (1-30)
        </h1>
        <p class="text-gray-500 mb-6 border-b pb-4">
            Input numbers (1-30) separated by commas or new lines. The 5x6 grid will update instantly. **The input is saved automatically.**
        </p>

        <!-- Input Area -->
        <div class="mb-8">
            <label for="numberInput" class="block text-lg font-medium text-gray-700 mb-2">Enter Numbers (1-30)</label>
            <textarea
                id="numberInput"
                rows="8"
                class="w-full p-4 border-2 border-indigo-500 rounded-lg shadow-inner focus:ring-custom-orange focus:border-custom-orange transition duration-150 ease-in-out resize-none text-base"
                placeholder="Example:
4,10,17,23,29
2,8,25
5,12,26"
            ></textarea>
        </div>

        <!-- Heatmap Grid Container (5 rows, 6 columns = 30 cells) -->
        <div id="heatmapGrid" class="heatmap-grid gap-1 p-2 bg-gray-200 rounded-xl border border-gray-300 shadow-lg">
            <!-- Grid cells will be generated here by JavaScript -->
        </div>

        <!-- Stats/Legend -->
        <div class="mt-6 p-4 bg-indigo-50 rounded-lg border border-indigo-200 flex flex-col sm:flex-row justify-between text-sm shadow-inner">
            <p id="totalCount" class="text-gray-600 mb-2 sm:mb-0">Total Valid Numbers: 0</p>
            <p id="maxFrequency" class="text-gray-600">Max Frequency: 0</p>
        </div>

    </div>

    <script>
        const inputElement = document.getElementById('numberInput');
        const gridContainer = document.getElementById('heatmapGrid');
        const totalCountDisplay = document.getElementById('totalCount');
        const maxFrequencyDisplay = document.getElementById('maxFrequency');
        const GRID_SIZE = 30; // The grid represents numbers 1 through 30
        const localStorageKey = 'numberInputData';

        // --- Local Storage Functions ---

        /** Loads data from local storage and populates the textarea. */
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem(localStorageKey);
            if (savedData) {
                inputElement.value = savedData;
            } else {
                 // Initial placeholder data if nothing is saved
                inputElement.value = `4,10,17,23,29
2,8,25
5,12,26
1,6,18,30
8,15,22,29
5,13,21,27
8,15,22,27,30
3,11,19,25,29`;
            }
        }

        /** Saves the current textarea content to local storage. */
        function saveToLocalStorage(data) {
            try {
                localStorage.setItem(localStorageKey, data);
            } catch (e) {
                console.error("Could not save to local storage:", e);
            }
        }

        // --- Utility Functions ---

        /**
         * Converts frequency to a color on the White -> Orange gradient (RGB interpolation).
         * @param {number} count - The frequency count for a number.
         * @param {number} maxCount - The highest frequency found in the dataset.
         * @returns {string} RGB color string (e.g., 'rgb(255, 255, 255)').
         */
        function getColorForFrequency(count, maxCount) {
            if (maxCount === 0 || count === 0) {
                return 'rgb(255, 255, 255)'; // Pure White
            }

            const ratio = count / maxCount;

            // Target Orange: #ff5722 (R: 255, G: 87, B: 34)
            // Start White: (R: 255, G: 255, B: 255)

            // Interpolate towards the orange color components
            const r = 255;
            const gEnd = 87;
            const bEnd = 34;
            const gStart = 255;
            const bStart = 255;

            // Interpolation: StartValue - ratio * (StartValue - EndValue)
            const g = Math.round(gStart - ratio * (gStart - gEnd));
            const b = Math.round(bStart - ratio * (bStart - bEnd));

            return `rgb(${r}, ${g}, ${b})`;
        }


        // --- Core Logic ---

        /**
         * Parses the input, calculates frequencies, updates the grid colors, and saves to local storage.
         */
        function updateGrid() {
            const rawText = inputElement.value;
            
            // Save the current state immediately
            saveToLocalStorage(rawText);

            // 1. Parse and Filter Numbers (1-30)
            const numbers = rawText
                // Replace all non-digit, non-comma, non-newline characters with space, then split by common separators
                .split(/[\s,]+/g)
                .map(s => parseInt(s.trim()))
                // Filter out invalid/empty entries (NaN) and numbers outside 1-30 range
                .filter(num => !isNaN(num) && num >= 1 && num <= GRID_SIZE);

            // 2. Calculate Frequencies
            const frequencies = {};
            let totalValidCount = 0;
            for (let i = 1; i <= GRID_SIZE; i++) {
                frequencies[i] = 0; // Initialize all counts to 0
            }

            numbers.forEach(num => {
                frequencies[num] = (frequencies[num] || 0) + 1;
                totalValidCount++;
            });

            // 3. Find Max Frequency for scaling
            const maxCount = Math.max(...Object.values(frequencies));

            // 4. Update UI Displays
            totalCountDisplay.textContent = `Total Valid Numbers: ${totalValidCount}`;
            maxFrequencyDisplay.textContent = `Max Frequency: ${maxCount}`;

            // 5. Update Grid Cell Colors and Counts
            for (let i = 1; i <= GRID_SIZE; i++) {
                const cell = document.getElementById(`cell-${i}`);
                if (cell) {
                    const count = frequencies[i] || 0;
                    const color = getColorForFrequency(count, maxCount);

                    cell.style.backgroundColor = color;
                    cell.querySelector('.count').textContent = count > 0 ? count : '';
                    cell.title = `Number ${i}: Count ${count}`;

                    // Add a slight ring/shadow to highlight the max frequency numbers
                    if (count === maxCount && maxCount > 0) {
                        cell.classList.add('ring-4', 'ring-custom-orange', 'ring-opacity-75');
                    } else {
                        cell.classList.remove('ring-4', 'ring-custom-orange', 'ring-opacity-75');
                    }
                }
            }
        }

        /**
         * Initializes the 5x6 grid structure (30 cells).
         */
        function initializeGrid() {
            let html = '';
            for (let i = 1; i <= GRID_SIZE; i++) {
                html += `
                    <div id="cell-${i}" class="grid-cell rounded-lg relative overflow-hidden transition-all duration-300">
                        <!-- Number label (top left) -->
                        <span class="cell-number-label absolute top-1 left-2 text-gray-500 font-normal opacity-70">${i}</span>
                        <!-- Frequency count (center) -->
                        <span class="count text-2xl sm:text-3xl font-extrabold text-gray-800"></span>
                    </div>
                `;
            }
            gridContainer.innerHTML = html;
        }

        // --- Event Listeners and Initial Setup ---

        // Attach event listener for real-time updates
        inputElement.addEventListener('input', updateGrid);

        // Run initialization on window load
        window.onload = function() {
            initializeGrid();
            loadFromLocalStorage(); // Load saved data
            updateGrid(); // Run update with loaded data
        };

    </script>
</body>
</html>
